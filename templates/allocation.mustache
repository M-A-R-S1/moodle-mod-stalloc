{{!
    This file is part of Moodle - http://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Moodle is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
}}
{{!
    @template mod_stalloc/allocation

    Display the home site of this plugin.
    Classes required for JS:
    * none
    Data attributes required for JS:
    * none
    Context variables required for this template:
    * none
}}


{{#allocation_time_needed}}
    <div class="alert alert-danger mb-5" role="alert">
        Achtung! Es wurde noch kein Zeitrahmen für das Losverfahren in den Einstellungen gesetzt. Bitte setzen Sie einen Zeitrahmen!
    </div>
{{/allocation_time_needed}}

<div id="accordion">

    {{#allocation_can_start}}
        <div class="card-body">
            <div class="ml-3">
                <form class="col-lg-6 col-sm-12" action="" method="post" >
                    <h2 class="mt-3 mb-3">Losverfahren starten?</h2>
                    <p class="lead">Teilnehmende Studenten: {{rated_student_count}}</p>
                    <div class="alert alert-warning mt-3" role="alert">
                        Achtung! Das Losverfahren kann nur einmal ausgeführt werden!
                    </div>
                    <button type="submit" name ="start_allocation" class="btn btn-success">Starten</button>
                </form>
            </div>
        </div>
    {{/allocation_can_start}}

    {{#allocation_time_over}}
        <div class="jumbotron mt-5">
            <h2>Die Zulosungsphase ist vorbei</h2>
            <p>Das Losverfahren kann nicht mehr durchgeführt werden.</p>
        </div>
    {{/allocation_time_over}}

    {{#allocation_time_not_started}}
        <div class="jumbotron mt-5">
            <h2>Die Zulosungsphase hat noch nicht begonnen</h2>
            <p>Das Losverfahren kann noch nicht durchgeführt werden. Bitte warten Sie bis die Zulosungsphase begonnen hat.</p>
        </div>
    {{/allocation_time_not_started}}

    {{#no_ratings}}
        <div class="jumbotron mt-5">
            <h2>Keine Prioritäten vorhanden</h2>
            <p>Die Zulosung kann nicht durchgeführt werden.</p>
            <p>
                Es existieren im moment noch keine studentischen Prioritäten, weswegen da Losverfahren nicht durchgeführt werden kann.<br>
                Bitte warten Sie, bis die Studenten ihre Prioritäten abgegeben haben.
            </p>
        </div>
    {{/no_ratings}}

    {{#allocations}}
        <div class="card-body">
            <div class="ml-3">
                <h2 class="mt-3 mb-3">Losverfahren Ergebnisse</h2>
                <div class="table-responsive">
                    <table class="table table-striped border mb-0">
                        <thead class="bg-dark text-light">
                        <tr>
                            {{#rating}}
                                <th scope="col">Priorität: {{priority}}</th>
                            {{/rating}}
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            {{#rating}}
                               <td>{{count}}</td>
                            {{/rating}}
                        </tr>
                        </tbody>
                    </table>
                </div>
                <h3 class="mt-5 mb-3">Nicht zugewiesen: {{unallocated}} </h3>
            </div>
        </div>
    {{/allocations}}

</div>